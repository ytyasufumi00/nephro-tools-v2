import streamlit as st

# ==============================================================================
# 1. コンテンツデータ (重要度順に並び替え済み)
# ==============================================================================
ICLS_DATA = {
    "❤️ BLS": [
        {
            "title": "BLSの孤立シチュエーション",
            "text": """
            **【対応】**
            * スマホのスピーカーフォン活用（通信指令員のPA）。
            * 通行人を具体的に指名して役割を振る。
            """
        },
        {
            "title": "衣類の除去・役割交代",
            "text": """
            **【衣類】**
            * 躊躇なく切る。ワイヤー入りブラジャーは外すか切る（分流・火傷防止）。
            
            **【交代】**
            * 疲労は2分でピーク。Pre-emptive orderで予告し、5秒以内でスライド交代する。
            """
        },
        {
            "title": "CCFとMICR",
            "text": """
            **【CCF (Chest Compression Fraction)】**
            * 圧迫している時間の割合。60%以上（目標80%）で生存率向上。
            
            **【MICR】**
            * アリゾナ・プロトコル。初期は人工呼吸を省略し、圧迫継続を最優先する手法。
            """
        }
    ],
    "⚡ 不整脈": [
        {
            "title": "脈ありＶＴの対応・同期/非同期",
            "text": """
            **【対応の原則】**
            * **不安定（意識障害、ショック、胸痛、心不全）:** 直ちに同期電気ショック。
            * **安定:** 薬剤投与を検討。

            **【同期 vs 非同期】**
            * **同期 (Synchronized):** QRS波の「R波」を感知し、受攻期（T波の頂点）を避けて放電する。脈がある頻拍（VT, AF, PSVT）で必須。
            * **非同期 (Asynchronized):** ボタンを押した瞬間に放電。VFや無脈性VT（R波がない、または認識できない場合）に使用。
            """
        },
        {
            "title": "r on Tの説明",
            "text": """
            **【解説】**
            * 心室の再分極過程（T波の頂点から終末にかけて）は、電気的に不安定な「受攻期（Vulnerable Period）」である。
            * このタイミングに外部刺激（R）が重なると、心室内で興奮の旋回が生じ、心室細動（VF）が誘発される現象。
            * これを防ぐために「同期」モードが存在する。
            """
        },
        {
            "title": "経皮ペーシング fixモードとr on T",
            "text": """
            **【モードの違い】**
            * **Demand:** 自己脈を感知（センス）して、無いときだけ打つ。基本はこちら。
            * **Fixed (Asynchronous):** 自己脈無視で一定のリズムで打つ。
            
            **【リスク】**
            * ノイズ等でDemandが作動しない場合にFixedにするが、自己脈が出た場合、ペーシング刺激がT波に重なり（R on T）、VFを誘発するリスクがある。
            """
        }
    ],
    "🔌 電気/AED": [
        {
            "title": "同期除細動の適応と推奨エネルギー",
            "text": """
            **【推奨エネルギー（二相性）】**
            * **心房細動 (AF):** **120〜200J**。閾値が高いため初回から強め。
            * **心房粗動 (AFL):** **50〜100J**。
            * **心室頻拍 (VT):** **100J**。
            * **発作性上室性頻拍 (PSVT):** **50〜100J**。
            """
        },
        {
            "title": "同期ショックのトラブル（放電しない？）",
            "text": """
            **【よくあるトラブル】**
            * 「ボタンを押したのに放電しない！」
            
            **【指導】**
            * 同期モードではR波を待つタイムラグがあるため、ボタンは**「長押し」**し続ける必要がある。
            """
        },
        {
            "title": "パドルのメリット、デメリット・クイックルック",
            "text": """
            **【パドルのデメリット】**
            * 10kgと圧着にかなり力を要する！
            * パドル in Airの恐怖！　拳銃を人に向けている様なもの。
            * そのジェルは間違いなく通電用？　ジェルはパドルではなく体に塗っておく、が、見えない、滑る、胸骨圧迫で困る、、ジェルパッドを推奨。
            * パドルはこすり合わせないで！　傷つくと抵抗が上昇し除細動失敗や熱傷のもとになる
            
            **【クイックルックのメリット、デメリット】**
            * 
            """
        },
        {
            "title": "AEDと無脈性VTのジレンマ",
            "text": """
            **【解説】**
            * AEDは「波形が整っているVT」に対して「脈があるかも？」と判断し、**ショック不要**と出ることがある。
            * 医療者は臨床所見（脈なし）を優先し、マニュアル除細動器でショックを行う必要がある。
            """
        },
        {
            "title": "AEDの詳細（トリビア・指導法）",
            "text": """
            **【ポイント】**
            * **インピーダンス測定:** 「AEDは『抵抗（インピーダンス）』を測っている」

ネタ: パッドを貼った瞬間、AEDは患者の「電気の通りにくさ」を計算しています。
解説: 体が大きい人、乾燥している人、筋肉質な人で電気抵抗は違います。多くのAEDは、抵抗が高いと判断すると自動的にジュール数を上げたり、通電時間を延ばしたりして、最適な電流が心臓に届くように調整しています。「ただの電池」ではなく「頭脳」が入っているのです。

「なぜ『離れてください』と言うのか？」
ネタ: 「感電するから」は半分正解ですが、最大の理由は違います。
解説: 解析中に触れると、その振動がノイズとなり、「心室細動（VF）」と誤認してチャージしてしまうからです。逆に、CPR中に解析できる最新機種（cprINSIGHT™搭載機など）は、ノイズを除去する技術が進化したため、中断時間がゼロになりつつあります。

2. パッド・貼付位置編
「右前胸部と左側胸部の『本当の意味』」
ネタ: なぜあの位置なのか？
解説: 心臓を「電気の通り道」で挟むためです。電気は最短距離を流れます。右鎖骨下（心基部）から左脇腹（心尖部）へ流すことで、心臓の筋肉のベクトルに沿って最も効率よく電気が流れます。
裏技: 実は**「前後（胸と背中）」**で挟むのが、電気的には最も心臓に近いので効率が良いとされています（小児やペースメーカー埋め込み患者で推奨）。しかし、成人で背中に貼るには体位変換が必要でCPRが中断するため、標準は「前・横」になっています。

「ネックレスやブラジャーの金具、実は…」
ネタ: 金具の上から貼ってはいけない本当の理由。
解説: 「火傷するから」もそうですが、もっと怖いのは**「電流が金属を伝って表面を走ってしまい（ショート）、心臓の中を通らなくなること」**です。これを「分流（Shunting）」と言います。せっかくの電気が心臓を素通りしてしまうのが最大の問題です。

「貼り薬（ニトロなど）の上から貼ると爆発する？」
ネタ: 貼り薬を剥がすべき理由。
解説: ニトログリセリンのパッチなどは、通電時の熱で引火・爆発するリスクがわずかにあります。また、薬剤が絶縁体となり電気が通りにくくなります。必ず剥がして薬剤を拭き取ります。

3. 歴史・トリビア編
「AEDの日本語訳は、昔は違った」
ネタ: 今は「自動体外式除細動器」ですが。
解説: 昔は**「非医療従事者用自動除細動器」**という長い名前で呼ばれることもありました。2004年に一般市民の使用が解禁されたのが日本の救急医療の最大の転換点です。
「日本は世界一のAED大国」
ネタ: 人口あたりの設置台数は世界トップクラスです。
解説: コンビニ、駅、学校、自動販売機…。ここまで密度が高い国は稀です。しかし、**「一般市民が使用した率（使用率）」はまだ数％**に留まっています。「あるのに使われない」のが日本の課題です。

「あの独特な『音声』の秘密」
ネタ: なぜあの、ちょっと緊迫感のある（または妙に落ち着いた）声なのか。
解説: 音響心理学に基づいて設計されています。パニック状態の人間が、騒音の中でも聞き取りやすく、かつ指示に従いやすい周波数やイントネーションが研究されています。子供用モードにすると、少し優しい声になる機種もあります。

4. インストラクター向け「ここだけの話」
「ペースメーカーが入っている人の波形」
ネタ: ペースメーカーのスパイク（刺激）をAEDはどう判断する？
解説: 昔のAEDはペーシングのスパイクを「QRS波」と誤認して「ショック不要」と判断してしまうことがありました。今のAEDは高性能なフィルターでスパイクを除去し、その裏にあるVF/VTを検知できます。だから**「ペースメーカーが入っていても、迷わず貼って解析」**が正解です。

「オートショックAED（ボタンがないAED）の登場」
ネタ: 最近増えている、ボタンがない機種。
解説: 解析してショックが必要なら、カウントダウン後に勝手に電気が流れます。救助者が「ボタンを押す恐怖」で躊躇をなくすためですが、「離れて！」の指示をより徹底させる必要があります。

講義での締めくくりに
「AEDはただの電気ショックの機械ではありません。 『心臓の状態を診断する優秀な心臓外科医』と『最適な電気を流すエンジニア』が、この小さな箱の中に詰まっています。
だから、私たちは安心して、その箱の指示に従うだけでいいんです」
            * **離れる理由:** 感電防止に加え、振動によるノイズ（VF誤認）を防ぐため。
            * **右前・左側:** 心臓を電流のベクトルで挟むため。「前後」も有効。
            * **ペースメーカー:** 現代のAEDはフィルタが優秀なので、スパイクがあってもVFを検知できる。迷わず貼る。
            """
        },
        {
            "title": "2重連続除細動 (DSD)",
            "text": """
            **【Double Sequential Defibrillation】**
            * 難治性VFに対し、2台の除細動器で「前側」「前後」にパッドを貼り、連続ショックを行う手法。
            """
        }
    ],
    "🫁 呼吸": [
        {
            "title": "500-600ml指導と5-6ml/kg",
            "text": """
            **【指導】**
            * 生理学的理想(6-8ml/kg)に対し、BVMは容量が大きいため、「半分」では多すぎる。
            * 「指先でクシュッと」「1/3握る」程度で十分。
            """
        },
        {
            "title": "換気回数とCCF",
            "text": """
            **【回数】**
            * 成人挿管後: 10回/分（6秒に1回）。
            
            **【CCFとの関係】**
            * 30:2の同期換気で4秒以上かけるとCCFが低下する。「1秒入れ、1秒出す」×2回＝4秒以内厳守。
            """
        },
        {
            "title": "過換気の害",
            "text": """
            **【メカニズム】**
            * 胸腔内圧上昇 → 静脈還流阻害。
            * 低CO2 → 脳血管収縮。
            """
        }
    ],
    "🧪 挿管/気道": [
        {
            "title": "挿管後の確認・管理",
            "text": """
            **【確認】**
            * 聴診（5点）よりも**波形カプノグラフィ**がGold Standard。
            * エコーも有効。
            * 比色式CO2検知器（イージーキャップ®など）
            *「Purple（紫）は、Problem（問題あり）。」 「Yellow（黄）は、Yes（OK）。」
            
            **【設定】**
            * トリガーはOFF（圧迫を自発呼吸と誤認させないため）。
            """
        },
        {
            "title": "ルーカス中の換気・BVMのコツ",
            "text": """
            **【コツ】**
            * ルーカスは圧迫時間が長い。圧解除の一瞬を狙う。
            * 非同期換気。
            """
        },
         {
            "title": "窒息、FBAO",
            "text": """
            **【FBAO】**
            * JRC2020では声掛け、背部抗打法5回→ハイムリッヒ法5回　
            * 
            """
        },
        {
            "title": "LT,コンビチューブ、i-gel",
            "text": """
            **【i-gelが良いが、4時間以内】**
            * LTは食道を完全に遮断できる訳ではなく、留置中、入れ替え時の嘔吐、誤嚥に注意が必要。バルーンによる阻血、や壊死にも注意。コンビチューブは煩雑であり絶滅危惧種。
            * I-gelは盲目的に留置が可能であり、首が短い等の挿管困難例で威力を発揮する。4時間以上の使用で静脈還流障害、巨舌を来し、再挿管が困難となるリスクがある。
            
            **【igel】**
            * カフなし、操作簡単。
            * 舌の循環障害リスクのため、使用は4時間以内を目安に。
            """
        }
    ],
    "💊 薬剤": [
        {
            "title": "不整脈用薬剤の詳細",
            "text": """
            * **アミオダロン:** 初回150mg 10分静注。維持投与あり。
            * **ニフェカラント:** 0.3mg/kg 静注。
            * **リドカイン:** 1〜1.5mg/kg 静注（虚血性心疾患疑い）。
            """
        },
        {
            "title": "ドパミン vs ノルアドレナリン",
            "text": """
            **【ノルアド優位】**
            * ドパミンは不整脈誘発リスクが高い。
            * 心原性ショック等では、ノルアドレナリンの方が死亡率が低い（または同等）ため第一選択。
            """
        }
    ],
    "💧 輸液": [
        {
            "title": "輸液・ルート確保",
            "text": """
            **【ルート確保】**
            * 心停止時は**上肢（肘正中など）**が推奨。
            * 骨髄路（IO）も早期に検討。
            * 輸液剤は細胞外液（リンゲル液、生理食塩水）。
            """
        }
    ],
    "🤝 チーム": [
        {
            "title": "フォロワーシップの3要素",
            "text": """
            1.  **Shared Mental Model:** 状況の共有。
            2.  **Speak Up:** 懸念の表明。
            3.  **Constructive Intervention:** 建設的介入。
            """
        },
        {
            "title": "過剰な配慮とハイジャック",
            "text": """
            **【過剰な配慮】**
            * 忖度は医療安全の敵。「命を守る指摘は失礼ではない」と教える。
            
            **【ハイジャック】**
            * メンバーが勝手に指示を出すのはNG。
            * リーダーが機能不全なら「交代します」と宣言して引き継ぐ。
            """
        }
    ],
    "🏥 蘇生後": [
        {
            "title": "TTM・シバリング・てんかん",
            "text": """
            **【TTM】**
            * 33-36℃、または「発熱回避（37.5℃以下）」。
            
            **【シバリング】**
            * 35-36℃で好発。皮膚加温、鎮静剤、筋弛緩剤で対応。
            
            **【てんかん】**
            * 蘇生後脳症に合併しやすい。予防投与も考慮。ミオクローヌスとの鑑別。
            """
        },
        {
            "title": "血糖管理",
            "text": """
            **【血糖】**
            * 推奨目標値: 144 〜 180 mg/dL（JRC2020 / AHA2020）　絶対に低血糖を起こさないように！
            *Leuven I study（2001年）が、その後の大規模多施設研究（NICE-SUGARなど）とは異なり、**「厳格な血糖管理（80-110 mg/dL）で劇的に予後が改善したのは、圧倒的なマンパワーがあったから、と言われている
            """
        },
        {
            "title": "CO2管理・4H4T",
            "text": """
            **【CO2管理】**
            * PaCO2 35-45mmHg（正常値）を目指す。低CO2は脳虚血のリスク。
            
            **【4H4T】**
            * PEA/Asystoleの原因検索。
            * Hypoxia, Hypovolemia, Hyper/Hypokalemia, Hypothermia
            * Tension pneumothorax, Tamponade, Toxins, Thrombosis
            """
        },
        {
            "title": "冠動脈疾患疑い対応",
            "text": """
            * 12誘導ST上昇確認。
            * 左上肢ルート確保（右はカテ用）。
            * 抗血小板薬、ヘパリン準備。
            """
        }
    ],
    "🎓 教育": [
        {
            "title": "BLS相互評価・シークレットインストラクション",
            "text": """
            **【相互評価】**
            * 受講生同士で「深さは？」「戻りは？」と指摘し合わせる。
            
            **【シークレットインストラクション】**
            * 特定の受講生に「わざと過換気して」「小声で話して」と指示し、リーダーが気づけるか試す手法。
            """
        }
    ],
    "👶 小児": [
        {
            "title": "小児蘇生のポイント",
            "text": """
            **【ポイント】**
            * **呼吸原性:** 原因の9割は酸欠。
            * **15:2:** 医療者2人なら換気重視の比率。
            * **気道:** スニッフィングポジション（肩枕）。
            """
        },
        {
            "title": "小児の換気回数、成人との大きな違い",
            "text": """
            **【違い】**
            * 成人: 10回/分（6秒に1回）。
            * 小児（高度気道確保後）: **20〜30回/分（2〜3秒に1回）**。
            * 理由: 代謝が高く、アシドーシス補正が必要なため。
            """
        },
        {
            "title": "小児でHR<60は脈を触知しても胸骨圧迫を考慮！",
            "text": """
            **【判断基準】**
            * 脈拍60未満 かつ
            * 循環不全のサイン（顔色不良、意識なし、反応なし）がある場合。
            * 迷わず胸骨圧迫を開始する。「徐脈は瀕死」。
            """
        }
    ],
    "🤰 妊産婦": [
        {
            "title": "妊産婦蘇生のポイント",
            "text": """
            **【ポイント】**
            *妊産婦の蘇生は、「母体と胎児、2つの命」を扱う特殊な状況ですが、鉄則は **「母体を救うことが、胎児を救う唯一の道である」**
          
          *【導入】 マインドセット（1分）
「妊婦の蘇生は特殊に見えますが、やることはABCです。ただし、『お腹が大きい』という生理学的変化が邪魔をします。それを解除するのが今回のポイントです」

* **ポイント①**：体位は「用手子宮左方圧排」が絶対（4分）
これが妊婦蘇生における最大かつ唯一の物理的な変更点です。ここを実技を含めて厚く説明します。
なぜ必要か（病態）:仰向け（仰臥位）になると、重たい子宮が下大静脈（IVC）を押し潰します（仰臥位低血圧症候群）。これでは、いくら胸骨圧迫をしても心臓に血が帰ってこず、ポンプが空回りします。
どうするか（Action）:
× 体全体を傾ける: 以前は推奨されましたが、体が斜めになると胸骨圧迫の力が逃げてしまい、質が落ちるため現在は推奨されません。
○ 子宮だけを退かす: 患者は仰向けのまま、救助者の一人が両手で子宮を「左側」へグイッと押し続けます（Manual Left Uterine Displacement）。
指導のコツ:
「誰か1人、**『子宮係』**が必要です！ 蘇生チームに人を呼ぶときは、この係の分も頭に入れてください」

*ポイント②：気道・呼吸は「早め・難しめ・高濃度」（3分）
妊婦は「酸素の予備能」が極端に低く、かつ「挿管困難」です。酸素消費と予備能:胎児がいるため酸素消費量が増えているのに、横隔膜が押し上げられて肺が小さくなっています。
「呼吸が止まると、秒単位でSpO2が下がります」。気道確保の難易度:ホルモンの影響で気道が浮腫んでいます。「挿管チューブは普段より0.5〜1.0mm細いもの（6.0〜6.5mmなど）」を用意させます。
誤嚥リスクが高いため、早期の確実な気道確保（挿管）が望ましいですが、失敗リスクも高いため、ビデオ喉頭鏡などの準備を強調します。

*ポイント③：除細動と薬剤は「通常通り」（2分）
「赤ちゃんに電気が流れませんか？」「薬は大丈夫ですか？」という不安を払拭します。
除細動（電気ショック）:**「全く通常通り」**です。エネルギー量も貼る位置も変わりません。羊水を通じて電気が少し減衰するかもしれませんが、胎児への悪影響を気にしてショックを遅らせる方が致命的です。
※モニターをつけている場合、外す暇があれば外しますが、邪魔ならつけたまま貼っても構いません。薬剤（アドレナリン等）:これも**「通常通り」**です。
【重要】 静脈路確保の位置: 子宮で圧迫されている下肢（足）からのルートは薬剤が届きにくいです。**必ず「横隔膜より上（腕など）」**から確保してください。

*ポイント④：究極の手段「死戦期帝王切開（PMCD）」（4分）
これが最もセンシティブですが、知識として知っておくべき「4分ルール」です。
概念:蘇生処置（CPR）を行っても反応がない場合、母体を救うために**「緊急帝王切開で赤ちゃんを出す」**手技です。
これは「赤ちゃんを助けるため」だけではありません。**「空になった子宮による圧迫を解除し、母体の静脈還流を劇的に改善させて、お母さんを蘇生させる」**ための手技（Resuscitative Hysterotomy）です。
5分ルール（4分で開始）:心停止から4分以内に切開を開始し、5分以内に胎児を娩出するのが目標です。5分を超えると、母体の脳障害リスクと胎児の死亡リスクが跳ね上がります。
場所:手術室への搬送を待っていては間に合いません。**「その場（ERや病室）」**で行う覚悟が必要です。

*【まとめ】（1分）
体位: 患者は仰向け、子宮だけを**「左へ手で押す」**。
呼吸: 酸素はすぐなくなる。挿管チューブは**「細め」**。
除細動・薬: 通常通り。ルートは**「腕」**から。
PMCD: 戻らなければ**「4分でカイザー」**。それは母体を救うための蘇生手技である。
「お母さんが助からないと、赤ちゃんも絶対に助かりません。まずは全力でお母さんの循環を戻しましょう」
            """
        }
    ],
    "🫀 移植": [
        {
            "title": "臓器提供の要点",
            "text": """
            **【対応】**
            * 脳死・心停止後臓器提供の可能性があればNWへ連絡。
            * 家族説明の前にコーディネーターへ相談（虐待除外など）。
            
            **【種類】**
            * 脳死下（心・肺・肝・腎など）、心停止後（腎・眼球）。
            """
        }
    ],
    "📘 GL": [
        {
            "title": "JRC2025・地域GL",
            "text": """
            **【JRC2025予想】**
            * 換気回数増加？（成人10回→?）
            * DSDの推奨度。
            * 回復体位の脊椎固定解除。
            
            **【議論】**
            * 回数を増やすなら一回換気量は減らすべき（肺保護）。
            """
        }
    ],
    "❓ その他": [
       {
            "title": "特定行為",
            "text": """
            **【救急救命士が可能な処置】**
            * ① 全ての救急隊員ができること（基本）　胸骨圧迫、人工呼吸（BVM）　AED（自動体外式除細動器）の使用　気道確保（用手、エアウェイ）　酸素投与（※講習修了者）　止血、固定、搬送
            * 条件に合致すれば、MC指示がなくても可能：i-gel等の気道確保。血糖測定　患者が所持しているアドレナリン筋注、
            * 医師の指示が必要：心肺停止時の静脈路確保、乳酸リンゲルの輸液、気管挿管(ビデオ喉頭鏡)、アドレナリン投与、ブドウ糖投与
            """
        },
        {
            "title":"緊急CAG,PCI",
            "text":"""
            **循環器内科医師が来るまでに**
            *冠動脈疾患（ACS/STEMI）による心停止（またはROSC後）と判断し、緊急カテーテル検査（CAG/PCI）へ移行する場合、循環器内科医が到着するまでの数分間に行う準備は**「Door-to-Balloon Time（病院到着からバルーン拡張までの時間）」の短縮**に直結します。

インストラクターとして、スタッフに指示すべき**「PCI直前アクションチェックリスト」**をまとめました。
1. ルート確保（Venous Access）
カテーテル操作の邪魔にならない場所を選定するのが鉄則です。
場所: 原則として**「左上肢」**に確保します。
理由: 多くの術者は**「右手首（橈骨動脈）」**からカテーテルを入れます。右腕に点滴ルートやマンシェットがあると、術者の邪魔になります。
また、鼠径部（大腿動脈/静脈）は、IABPやECMO（PCPS）を入れる場所として空けておくのが理想です。
サイズ: 造影剤や輸血に対応できるよう、**20G以上（できれば18G）**を確保します。
本数: 昇圧剤用と、輸液/鎮静剤用に2ルートあると安心です。
2. 投薬（Medication）
カテーテル治療を行うためには、血液をサラサラにする薬（抗血小板薬・抗凝固薬）が必須です。医師の指示下で準備・投与します。
抗血小板薬（DAPT）のローディング:
アスピリン（バイアスピリン） ＋ P2Y12阻害薬（エフィエント/プラビックス）。
意識がない場合: 経口摂取できないため、**経鼻胃管（NGチューブ）**を挿入し、粉砕して注入します（これが最もタイムロスになりがちなので、早期に準備します）。
ヘパリン:通常、カテーテル室で投与しますが、ERで先行投与する場合もあります（プロトコルによる）。
循環作動薬:ノルアドレナリン等をシリンジポンプで準備し、血圧（MAP > 65mmHg）を維持します。
鎮静・鎮痛:体動があるとカテーテル操作が危険です。プロポフォールやロクロニウム等で不動化を維持します。
3. モニタリング・処置（Preparation）
除細動パッドの貼付位置:カテーテル透視（レントゲン）の邪魔にならないよう、かつ即座にショックができる位置に貼ります。
推奨: **前胸部ー背部（A-P）**装着。これなら胸部の透視の邪魔になりにくいです。※通常の右前ー左側だと、LAD（左前下行枝）を見るカメラアングルでパッドが影になることがあります。
更衣・準備:検査着に着替えさせるか、すべての衣服を切断・除去します（透視の邪魔になる金属類、ブラジャー、ネックレス等はすべて外す）。
両側の鼠径部（足の付け根）の脈を触れやすくしておきます（剃毛はカテ室でやることが多いですが、バリカンがあれば施行）。
4. 各部門への連絡（Communication）
「カテやります」だけでなく、**「今何が必要か」**を伝えます。放射線科（技師）:臨床工学技士（ME/CE）:病棟/ICU:家族対応（事務・看護師）:【最重要】 緊急カテーテル検査および輸血、場合によっては補助循環（ECMO/IABP）に関する同意書が必要です。
至急、家族を個室へ誘導し、医師からの説明（IC）の準備をしてください」
まとめ：リーダーが出すべき指示の例「循環器内科の先生が来るまでに、PCIの準備を完了させます！ルートは『左腕』に2本取り直して。右手首は空けておいて！マーゲンチューブ（NG管）を入れて、アスピリンとエフィエントを粉砕注入する準備を！除細動パッドは『前後』に貼り直して。家族には『緊急でカテーテル手術が必要』と伝え、待合室で待機させて！」このように、具体的なアクションを指示することで、チームは迷わずに動けます。
 """
   },
        {
            "title": "準備中",
            "text": """
            (内容拡充中...)
            """
        }
    ]
}

# ==============================================================================
# 2. アプリケーション設定・UI構築
# ==============================================================================
def main():
    st.set_page_config(
        page_title="ICLS Guide",
        page_icon="🚑",
        layout="wide"
    )

    # CSS: タブの文字サイズ調整と余白削減
    st.markdown("""
        <style>
            .block-container {
                padding-top: 1rem;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            /* タブの見た目を調整 */
            .stTabs [data-baseweb="tab"] {
                padding-left: 10px;
                padding-right: 10px;
                padding-top: 5px;
                padding-bottom: 5px;
                font-size: 13px; /* スマホで見やすいサイズ */
            }
            /* タブリスト（スクロール領域）の調整 */
            .stTabs [data-baseweb="tab-list"] {
                gap: 5px;
            }
        </style>
    """, unsafe_allow_html=True)

    st.title("🚑 ICLS Instructor Guide")

    # ---------------------------------------------------------
    # 横スクロール式のタブ（st.tabs）を作成
    # ---------------------------------------------------------
    # 辞書順＝表示順なので、作成したリストの順番通りにタブが並びます
    tab_titles = list(ICLS_DATA.keys())
    tabs = st.tabs(tab_titles)

    # 各タブの中にコンテンツを描画
    for i, title in enumerate(tab_titles):
        with tabs[i]:
            items = ICLS_DATA[title]
            for item in items:
                with st.expander(f"📌 {item['title']}", expanded=False):
                    st.markdown(item['text'])

if __name__ == "__main__":
    main()
